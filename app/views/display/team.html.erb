<h1><%= @team.name %></h1>
<h2><%= @team.grouping.fullname %></h2>

<h3>Standings</h3>
<table class="standings">
  <thead>
    <tr>
      <th>Team</th>
      <%= standings_headers(@competition) %>
    </tr>
  </thead>

 <tbody>
      <!-- Show sorted, unique Teams -->
    <% @groupingteams.sort{ |a,b| @competition.compare_teams(a, b) }.each do |team| %>
      <tr>
        <td><%= team_link_for team %></td>
      <%=  standings_row(@competition, team) %>
      </tr>
    <% end %>
  </tbody>
</table>


<h3>Scores</h3>
<table class="schedule">
  <thead>
    <tr>
      <th>Date</th>
      <th> </th>
      <th>Score</th>
      <th>Opponent</th>
      <th>Location</th>
    </tr>
  </thead>

  <tbody>
      <!-- Show sorted, unique Contests with Scores -->
    <% moreThanOneType = (@scores.collect{|c|c.type}.uniq.size()>1) %> 
    <% lastType = nil %>
    <% lastDate = nil %>
    <% @scores.each do |c| cntst = c.contest %>
      <% if moreThanOneType && cntst.type != lastType %>
        <tr><th class="typeBanner" colspan="5"><%= group_results_section_label(cntst.competition,cntst.type() )%></th></tr>
	<% lastType = cntst.type() %>
       <% end %>
      <tr>
        <td><%= cntst.display_date == lastDate ? " " : lastDate = cntst.display_date %></td>
        <td><%= c.win ? "W" : (c.loss ? "L" : "D") %></td>
        <td><%= c.score %> - 
	      <%= c.opponent.score %></td>
        <td><%= c.homeaway=='H' ? "vs" : "at" %>
	      <!-- %= c.opponent.fullname % --><%= team_link_for c.opponent.team %></td>
        <td><%= cntst.venue_name %></td>
      </tr>
    <% end %>
  </tbody>
</table>


<% if @contestants.select{|c| c.contest.needs_score?}.size()>0 %>
<h3>Schedule</h3>
<table class="schedule">
  <thead>
    <tr>
      <th>Team Name</th>
      <th>Date</th>
      <th>Time</th>
      <th>Location</th>
      <th>Opponent</th>
    </tr>
  </thead>

  <tbody>
      <!-- Show sorted, unique Teams -->
    <% lastDate = nil %>
    <% @contestants.select{|c| c.contest.needs_score?}.sort{|a,b| a.contest <=> b.contest}.each do |c| cntst = c.contest %>
      <tr>
         <td><%= c.fullname %></td>
        <td><%= cntst.display_date == lastDate ? " " : lastDate = cntst.display_date %></td>
        <td><%= cntst.display_time %></td>
        <td><%= cntst.venue_name %></td>
        <td><%= c.homeaway=='H' ? "vs" : "at" %>
	      <%= c.opponent.fullname %></td>
      </tr>
    <% end %>
  </tbody>
</table>
<% else %>
<h3>No Contests Scheduled</h3>
<% end %>


<%= link_to 'Request Email/SMS Updates',
                   alert_request_path(@competition, @team) %>
